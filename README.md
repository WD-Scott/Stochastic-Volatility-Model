![Static Badge](https://img.shields.io/badge/Repo_Status%3A-Final_Release-blue?style=flat&logo=data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAC0AAAAiCAMAAAD8kqB9AAAClFBMVEUAAAD%2F%2F%2F%2FBYzTCysr2WxvyQRLnSibjUy3VZSLbQyvSjHHIjEX5%2F%2F%2F5%2B%2FvIz9D8%2F%2F%2F4WhryWRz3QBHxUR7ySh%2FxbBjsTiHwbxnnTCXVQiz96eTg4N%2Fd3dzL0tH0XDPFzc32SRv0UB%2F3WRr4XRn1SR32VBv1Uhz0TB71URz0QBDySh3%2FYAP4ZxT1YxnwXRz0ZxnvTh7vVR7yPhDxQhfrTB%2FcVCLfRSzUUCfdPCbLciPQOjLu8fHc5OXn5eT85uHj4uHY19bKt6%2F3WBv2Uhv0WS%2F1TSDyWjT0Sx33XBr3Vhv0Vxz3XRr3Xhr1Uhv0Ux30SRv0Whv3Yhn2Xhr0UhzzPg%2F2RBb0Tx7zPg%2FzPg7zUR33YxjyTh%2F7XgL6WQDxTh%2FwVB%2F3Pw%2FzPA3wTh7zYRv1aBntTCDxXhzrTx%2FwSh7oYCDxaxjuTiDmSyHsWR7rPxnoQiXnchrmehr%2B9%2FTs7%2FD%2B7unW2djQ19jm2dbHxcLKuLD3v6%2FJrKL1SRvvelv25ePBxML7aRfg7%2FbS5ezY7PDA1t32VBv2UBz0SR70QxT0QxT0QxT2VRv1VRz3Yhn1Sx34VRvyTB%2F1Sh71Rhj2Uhz2TBj3YRn3Yxn1RBb5ZBfxTB%2F2ZBn7Zgz4Zhj4QhPuWB30ZBrySR3yXhzvSyDvWRv3PxDvTR%2F0WRzyYhvyPQ32aRryahrvViDuYhnxQRPzbRrsRh%2FYXSPuchnrcxjRp5vqbEr5v6%2F0cU3wWDD849vQqqD3pI32n4b2moDfhmznlmTocVD0XjX5Vhrl5ubKtKvirZ%2FPpprTpZbWnI%2F8q3z2lnv4lHn5pXXwn27fhGrfgmjlkF%2F5klzmclPjcFD1bUn0Z0Ptd0H3bDb0VCr0WyT4WRn7YRf4PQvBMCeZAAAAs3RSTlMA%2FQj72VQnHBIPBgX%2B%2Fv78%2BKqajGI0LyolBv7%2B%2Fv79%2FPX09PTu287Cv7%2B1oqCTi394c1pONCIYFRINCv7%2B%2Fv7%2B%2Fv79%2Ffv39fHw7evp4uHS0M%2FMysXFwbq4s7Cwq6SimpGQgX59eHJoYFlRUElHRD8sGRX%2B%2Fv7%2B%2Fv7%2B%2Fv7%2B%2Fv38%2FPv6%2Bvn57u3p4%2BLd19bV0tLNzcrIwsC5trSnp6eioJ%2Bem5uVlZWRkIiDbmlcS0tEOTQjHZlkpy4AAAI7SURBVDjLYqAPyBHU0Y6NjZlvCuZxLp%2BtrR2jI5iOS7nWjX2nT1xQ5ARzuKdc3Xf%2BzDV%2Fdlyq2dt3NvHbqUhAzJ50vKWxzi0Pt1sSttRLM25bAWYbbXd0YDwVgcflEirH%2BHi2dpoBmVyhe%2BWtd7isBTLxGM4MNDyRQZKBdXtlKf%2FJCLzBwua%2BGWh4BzsDE8RoY%2FyhuGQLsz3%2F5USg0Y4yjHvCufCrZlPYLMuztYt9%2Bjk%2BXjs5Y0JRJAQ0nHFbiNthaaDRQD4RhlfdPsvHKyXHSjj%2BhfYz2xbVVtsw7tbkIqxaAmg4b3kFwmjChh%2BSgRhNGIi57iyTKS45YIRDHiAONMMvyjvw70Iz2hzOMs3kQDX8qI3UARRXc2duQJLXW4MsN%2FdS864QJiQBUb1cZHnTeQvFETwTxSNXkFxdoCdoguZ2wwDdjXDOguvqcKMLkwOEOTG8mh%2FpoysOM7xGBMrapM8SnIM1aDL8PGat4waxJFPZIe7V9fZNlcQRklYiagKB%2BqLcEJ74yqlKqklmeGLGyjjSU3laimiB%2BCrAoryVwkTMgYGHUzHIUjMDr1sNPso3BeLZcKpjMmfisEwTzErRiQpUVurXmNgm0Dtjjn7WsuRCDqAMWvj1%2BAWxsHgcdPJUnRwnst6CwVIsQ1ij28vpoAALS5Ca6mIU1aujVaINklp9s%2FMtkEQ52fKCneMN4tzDDNGcsmiCsIZzGoYLcxXVhNW1mNCFLZb6q2MrILO1%2BmZKYPMorlBlIBcAACpxj1lvNSqgAAAAAElFTkSuQmCC&labelColor=%23232D4B&color=%23E57200)

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

# Bayesian Machine Learning ‚Äì Stochastic Volatility Model:

## Metadata:

This repo includes the Python code for a Stochastic Volatility Model of Apple stock returns from 2007-2022.

I developed this project for the DS6040 (Bayesian Machine Learning) Data Science masters program at the University of Virginia.

## Synopsis:

Apple stock returns exhibit high time-varying volatility ‚Äì quite stable sometimes, highly variable at others, and the distribution of market returns is highly non-gaussian. Thus, sampling Apple stock volatilities would be very difficult.

Stochastic Volatility (SV) models help capture such dynamic volatility, creating a more realistic representation of changing market risks. As a Bayesian method, these models provide uncertainty estimates, enabling better risk management.

To develop the model, I pull the data from the `yfinance` package into a Pandas dataframe and calculate a 'returns' column as the difference in the logarithmic returns, which I then use to model the volatility.

I model the logarithm of the daily returns¬†with a¬†Student-T distribution, parameterized by:
- the degrees of freedom¬†($ùúà$)¬†following an exponential distribution 
- volatility¬†($ùë†_ùëñ$),¬†where¬†($ùëñ$)¬†is the time index 

The volatility follows a Gaussian random walk¬†across all time steps, parameterized by a common variance given by an exponential distribution.

I model the logarithmic returns at each time point. 

The model allows the volatility to change over time, such that the volatility at each time point is controlled by a parameter for that time point ($ùë†_ùëñ$). 

However, the scale parameters ($ùë†_ùëñ$) at each time point cannot be completely independent; otherwise, the model would overfit the data.

One thing worth noting is that I have a single variance (ùúé) for the volatility process across all time, which may not represent the true nature of stock return behavior.

<div align="center">
    <img src="images/plate_not.png">
</div>
<p align="center">

I use the `PyMC` package to develop the SV model by writing a basic function that takes the Pandas dataframe as its input and returns the PyMC model. The model is parametrized by the stochastic process previously described to capture the volatility dynamics.

```python
def sv_model(data):
    with pm.Model(coords={"time": data.index.values}) as model:
        ùúé = pm.Exponential("ùúé", 10)
        volatility = pm.GaussianRandomWalk(
            "volatility", sigma=ùúé, 
            dims="time", init_dist=pm.Normal.dist(0, 100)
        )
        ùúà = pm.Exponential("ùúà", 0.1)
        r = pm.StudentT(
            "r", nu=ùúà, 
            lam=np.exp(-2 * volatility), 
            observed=data["return"], dims="time"
        )
    return model


svol_model = sv_model(df)
```

The notebook includes several visualizations with markdown cells above them providing descriptions.

## Data:

I pulled the Apple stock data from the Yahoo Finance package for 2007 through 2022.

- - - -
## Main Packages and Dependencies:

`PyMC`:     5.6.1

`Numpy`:    1.23.5

`Pandas`:   2.0.3

`Arviz`:    0.16.1

`Sklearn`:  1.3.0
- - - -

## Manifest:

### Files in repo:
* SVM.ipynb
* apple2.csv
* LICENSE
* README.md
